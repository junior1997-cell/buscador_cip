<!-- MDOAL - AGREGAR USUARIO -->
<div class="modal fade" id="modal-contacto-desarrollador">
  <div class="modal-dialog modal-dialog-scrollable modal-lg">
    <div class="modal-content">
      <div class="modal-header">
        <h4 class="modal-title">Contacto con desarrolladores</h4>
        <button type="button" class="close" data-dismiss="modal" aria-label="Close">
          <span class="text-danger" aria-hidden="true">&times;</span>
        </button>
      </div>

      <div class="modal-body">
        <div class="card-body">
          <div class="row" >
            <!-- Tipo de documento -->
            <div class="col-lg-6">
              <!-- Widget: user widget style 1 -->
              <div class="card card-widget widget-user shadow">
                <!-- Add the bg color to the header using any of the bg-* classes -->
                <div class="widget-user-header bg-info">
                  <h3 class="widget-user-username">David Requejo Santa Cruz</h3>
                  <h5 class="widget-user-desc">Desarrollador de sofware</h5>
                </div>
                <div class="widget-user-image">
                  <img class="img-circle elevation-2" src="../dist/img/desarrolladores/david.jpeg" alt="User Avatar" />
                </div>
                <div class="card-footer">
                  <div class="row justify-content-center">
                    <div class="col-4  col-sm-4  border-right">
                      <div class="description-block">
                        <h5 class="description-header nombre_contacto">WhatsApp</h5>
                        <a href="https://api.whatsapp.com/send?phone=+51921305769&text=*Hola buenos dias amigo desarrollador!!*" target="_blank" class="description-text desarrollador-whatsapp"><i class="fab fa-whatsapp fa-3x"></i></a>
                      </div>
                      <!-- /.description-block -->
                    </div>
                    <!-- /.col -->
                    <div class="col-4  col-sm-4 border-right">
                      <div class="description-block">
                        <h5 class="description-header nombre_contacto ">Facebook</h5>
                        <a href="https://www.facebook.com/david.requejo.1029"  target="_blank" class="description-text desarrollador-facebook"><i class="fab fa-facebook fa-3x"></i></a>
                      </div>
                      <!-- /.description-block -->
                    </div>
                    <!-- /.col -->
                    <div class="col-4  col-sm-4">
                      <div class="description-block">
                        <h5 class="description-header nombre_contacto">Linkedin</h5>
                        <a href="https://www.linkedin.com" target="_blank" class="description-text desarrollador-linkedin"><i class="fab fa-linkedin fa-3x"></i></a>
                      </div>
                      <!-- /.description-block -->
                    </div>
                    <!-- /.col -->
                  </div>
                  <!-- /.row -->
                </div>
              </div>
              <!-- /.widget-user -->
            </div>

            <!-- Pdf 1 -->
            <div class="col-lg-6">
              <!-- Widget: user widget style 1 -->
              <div class="card card-widget widget-user shadow">
                <!-- Add the bg color to the header using any of the bg-* classes -->
                <div class="widget-user-header bg-warning">
                  <h3 class="widget-user-username">Junior Cercado Vasquez</h3>
                  <h5 class="widget-user-desc">Desarrollador de sofware</h5>
                </div>
                <div class="widget-user-image">
                  <img class="img-circle elevation-2" src="../dist/img/desarrolladores/junior.png" alt="User Avatar" />
                </div>
                <div class="card-footer">
                  <div class="row justify-content-center">
                    <div class="col-4  col-sm-4 col-sm-4 border-right">
                      <div class="description-block">
                        <h5 class="description-header nombre_contacto">WhatsApp</h5>
                        <a href="https://api.whatsapp.com/send?phone=+51921487276&text=*Hola buenos dias amigo desarrollador!!*" target="_blank" class="description-text desarrollador-whatsapp"><i class="fab fa-whatsapp fa-3x"></i></a>
                      </div>
                      <!-- /.description-block -->
                    </div>
                    <!-- /.col -->
                    <div class="col-4  col-sm-4 col-sm-4 border-right">
                      <div class="description-block">
                        <h5 class="description-header nombre_contacto">Facebook</h5>
                        <a href="https://www.facebook.com/junior.cercado.v/"  target="_blank" class="description-text desarrollador-facebook"><i class="fab fa-facebook fa-3x"></i></a>
                      </div>
                      <!-- /.description-block -->
                    </div>
                    <!-- /.col -->
                    <div class="col-4  col-sm-4 col-sm-4">
                      <div class="description-block">
                        <h5 class="description-header nombre_contacto">Linkedin</h5>
                        <a href="https://www.linkedin.com/in/junior-cercado-v%C3%A1squez-344586208/" target="_blank" class="description-text desarrollador-linkedin"><i class="fab fa-linkedin fa-3x"></i></a>
                      </div>
                      <!-- /.description-block -->
                    </div>
                    <!-- /.col -->
                  </div>
                  <!-- /.row -->
                </div>
              </div>
              <!-- /.widget-user -->
            </div>
          </div>          
        </div>
      </div>

      <div class="modal-footer justify-content-end">
        <!-- <button type="button" class="btn btn-danger" data-dismiss="modal">Close</button> -->
        <button type="button" class="btn btn-danger" data-dismiss="modal">Close</button>
      </div>
    </div>
  </div>
</div>

<!-- MDOAL - VER PROYECTOS -->
<div class="modal fade" id="modal-para-todos-los-modulos-proyecto">
  <div class="modal-dialog modal-dialog-scrollable modal-lg">
    <div class="modal-content">
      <div class="modal-header">
        <h4 class="modal-title">Proyectos</h4>
        <button type="button" class="close" data-dismiss="modal" aria-label="Close">
          <span class="text-danger" aria-hidden="true">&times;</span>
        </button>
      </div>

      <div class="modal-body">
        <div class="row">
          <div class="col-12">
            <table id="tabla-para-todos-los-modulos-proyecto" class="table table-bordered table-striped display" style="width: 100% !important;">
              <thead>
                <tr>
                  <th>#</th>
                  <th class="">OP</th>
                  <th>Empresa</th>
                  <th>Código</th>                     
                  <th>Costo</th>                  
                  <th>Estado</th>
                </tr>
              </thead>
              <tbody>  </tbody>
              <tfoot>
                <tr>
                  <th>#</th>
                  <th class="">OP</th>
                  <th>Empresa</th>
                  <th>Código</th>                      
                  <th>Costo</th>                  
                  <th>Estado</th>
                </tr>
              </tfoot>
            </table>
          </div>
        </div>
      </div>

      <div class="modal-footer justify-content-between">
        <button type="button" class="btn bg-dark" onclick="salir_proyecto_para_todos_los_modulos();" >Salir de proyecto</button>
        <button type="button" class="btn btn-danger" data-dismiss="modal">Close</button>
      </div>
    </div>
  </div>
</div>

<script>

  function salir_proyecto_para_todos_los_modulos() {
    

    let timerInterval
    Swal.fire({
      title: 'Cerrando!!',
      html: `Tu proyecto <span class="text-danger text-bold"> se esta cerrado</span> <br> La página se recargara en <b></b> seconds`,
      timer: 3000,
      timerProgressBar: true,
      didOpen: () => { Swal.showLoading(); const b = Swal.getHtmlContainer().querySelector('b'); timerInterval = setInterval(() => { b.textContent = Swal.getTimerLeft(); }, 100); },
      willClose: () => { clearInterval(timerInterval)   }
    }).then((result) => { 

      if (result.dismiss === Swal.DismissReason.timer) { 

        localStorage.setItem('nube_idproyecto', 0);
        localStorage.setItem('nube_fecha_inicial_proyecto', '');
        localStorage.setItem('nube_fecha_final_proyecto', '');
        localStorage.setItem('nube_nombre_proyecto', '');

        window.location.reload(); 
      } 
    });
  }

  function abrir_proyecto_para_todos_los_modulos(idproyecto, ec_razon_social, nombre_proyecto, fecha_inicial, fecha_final) {

    let timerInterval
    Swal.fire({
      title: 'Abriendo!!',
      html: `<span class="text-success text-bold">${nombre_proyecto}</span> <br> Tu proyecto <span class="text-success text-bold">se está abriendo</span>, la página se recargara en <b></b> seconds`,
      timer: 3000,
      timerProgressBar: true,
      didOpen: () => { Swal.showLoading(); const b = Swal.getHtmlContainer().querySelector('b'); timerInterval = setInterval(() => { b.textContent = Swal.getTimerLeft(); }, 100); },
      willClose: () => { clearInterval(timerInterval)   }
    }).then((result) => { 
      
      if (result.dismiss === Swal.DismissReason.timer) { 

        if ($("#foo" ).hasClass('className')) { $( "#foo" ).removeClass( 'className'); } else { $( "#foo" ).addClass( 'className'); }

        if ( localStorage.getItem('nube_idproyecto') ) { $("#icon_folder_"+localStorage.getItem('nube_idproyecto')).html('<i class="fas fa-folder"></i>'); }

        $("#icon_folder_"+idproyecto).html('<i class="fas fa-folder-open"></i>')

        localStorage.setItem('nube_idproyecto', idproyecto);
        localStorage.setItem('nube_fecha_inicial_proyecto', fecha_inicial);
        localStorage.setItem('nube_fecha_final_proyecto', fecha_final);
        localStorage.setItem('nube_nombre_proyecto', nombre_proyecto);
        localStorage.setItem('nube_empresa_a_cargo', ec_razon_social);

        // mostramos el nombre en el NAV
        $("#ver-proyecto").html(`<i class="fas fa-tools"></i> <p class="d-inline-block hide-max-width-1080px">Proyecto:</p> ${nombre_proyecto}`);
        $("#ver-proyecto").show();
        $("#ver-otros-modulos").show();

        setTimeout(function() { $(".ver-otros-modulos-1").fadeOut(0);  },0);
        setTimeout(function() { $(".ver-otros-modulos-2").fadeIn(150); },4);
        setTimeout(function() { $(".ver-otros-modulos-2").fadeOut(200); },400);
        setTimeout(function() { $(".ver-otros-modulos-1").fadeIn(400); },500);

        window.location.reload(); 
      } 
    });

    $(".tooltip").removeClass("show").addClass("hidde");
  }

  //Función Listar en curso o no empezados
  function tbla_principal_para_todos_los_modulos(estado = 3) {    

    var tabla_proyectos = $('#tabla-para-todos-los-modulos-proyecto').dataTable({
      responsive: true,
      lengthMenu: [[ -1, 5, 10, 25, 75, 100, 200,], ["Todos", 5, 10, 25, 75, 100, 200, ]],//mostramos el menú de registros a revisar
      aProcessing: true,//Activamos el procesamiento del datatables
      aServerSide: true,//Paginación y filtrado realizados por el servidor
      dom: '<Bl<f>rtip>',//Definimos los elementos del control de tabla
      buttons: [  ],
      ajax:{
        url: `../ajax/proyecto.php?op=tbla_principal_para_todos_los_modulos&estado=${estado}`,
        type : "get",
        dataType : "json",						
        error: function(e){
          console.log(e.responseText); ver_errores(e);
        }
      },
      createdRow: function (row, data, ixdex) {
        // columna: #
        if (data[0] != '') { $("td", row).eq(0).addClass("text-center"); }
        // empresa
        if (data[2] != '') { $("td", row).eq(2).addClass("text-nowrap"); }
        // codigo
        if (data[3] != '') { $("td", row).eq(3).addClass("text-nowrap"); }
        // columna: costo
        if (data[4] != '') { $("td", row).eq(4).addClass("text-right text-nowrap"); }
      },
      language: {
        lengthMenu: "Mostrar: _MENU_ registros",
        buttons: { copyTitle: "Tabla Copiada", copySuccess: { _: "%d líneas copiadas", 1: "1 línea copiada", }, },
        sLoadingRecords: '<i class="fas fa-spinner fa-pulse fa-lg"></i> Cargando datos...'
      },
      bDestroy: true,
      iDisplayLength: 10,//Paginación
      order: [[ 0, "asc" ]],//Ordenar (columna,orden)
      columnDefs: [
      { targets: [4], render: function (data, type) { var number = $.fn.dataTable.render.number(',', '.', 2).display(data); if (type === 'display') { let color = 'numero_positivos'; if (data < 0) {color = 'numero_negativos'; } return `<span class="float-left">S/</span> <span class="float-right ${color} "> ${number} </span>`; } return number; }, },

        // { targets: [6], visible: false, searchable: false, },             
      ],
    }).DataTable();   

  }

</script>
